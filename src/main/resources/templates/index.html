<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>PowerShell Terminal Web</title>
    <style>
        body {
            font-family: 'Consolas', monospace;
            background-color: [[${theme.backgroundColor}]];
            color: [[${theme.textColor}]];
            margin: 0;
            padding: 20px;
        }

        .terminal-window {
            width: 80%;
            margin: 0 auto;
            border: 1px solid #555;
            height: 500px;
            padding: 10px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
        }

        .output-area {
            flex-grow: 1;
            overflow-y: auto;
            margin-bottom: 10px;
            white-space: pre-wrap;
        }

        .input-area {
            display: flex;
            border-top: 1px solid #555;
            padding-top: 10px;
            align-items: center;
        }

        .prompt-container {
            margin-right: 10px;
        }

        input[type="text"] {
            flex-grow: 1;
            background-color: transparent;
            border: none;
            color: [[${theme.commandColor}]];
            font-family: 'Consolas', monospace;
            font-size: 16px;
            outline: none;
        }

        .history-line {
            margin-bottom: 2px;
        }

        .controls {
            width: 80%;
            margin: 0 auto 20px auto;
            text-align: right;
            display: flex;
            justify-content: flex-end;
            gap: 20px;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }
    </style>
</head>
<body>

<div class="controls">
    <form action="/change-theme" method="post" class="control-group">
        <label>Theme: </label>
        <select name="themeName" onchange="this.form.submit()">
            <option value="dark" th:selected="${currentThemeName == 'dark'}">Dark</option>
            <option value="light" th:selected="${currentThemeName == 'light'}">Light</option>
        </select>
    </form>

    <form action="/change-engine" method="post" class="control-group">
        <label>Engine (Bridge): </label>
        <select name="engineType" onchange="this.form.submit()">
            <option value="windows" th:selected="${currentEngine == 'windows'}">Windows PowerShell</option>
            <option value="mock" th:selected="${currentEngine == 'mock'}">Mock / Test</option>
        </select>
    </form>
</div>

<div class="terminal-window">
    <div class="output-area" id="output">
        <div th:each="line : ${history}" class="history-line" th:utext="${line}"></div>
    </div>

    <div class="input-area">
        <div class="prompt-container" th:utext="${promptHtml}"></div>

        <form action="/execute" method="post" style="flex-grow: 1; display: flex;">
            <input type="text" name="commandText" autofocus autocomplete="off" placeholder="Введіть команду..." />

            <div th:utext="${buttonHtml}"></div>
        </form>
    </div>
</div>

<script>
    var output = document.getElementById("output");
    output.scrollTop = output.scrollHeight;
</script>

</body>
</html>